# モバイルデバイス実機テスト手順書

## 概要

このドキュメントでは、宇美町施設予約検索システムのモバイルデバイス実機テストの実施方法を説明します。

## テスト対象デバイス・ブラウザ

### 必須テスト環境

- **iOS Safari 14以上** (iPhone)
  - iOS 14.0以上のiPhone（iPhone 7以降推奨）
  - Safari ブラウザ

- **Android Chrome 90以上**
  - Android 9.0以上のスマートフォン
  - Chrome ブラウザ バージョン90以上

### 推奨追加テスト環境

- iPad Safari（タブレット検証）
- Androidタブレット Chrome（タブレット検証）

## テスト前準備

### 1. テストURLの準備

#### ローカル環境でのテスト

1. 開発サーバーを起動
   ```bash
   pnpm dev
   ```

2. ローカルネットワークでアクセス可能にする
   - Mac/Linuxの場合、ローカルIPアドレスを確認
     ```bash
     ifconfig | grep "inet " | grep -v 127.0.0.1
     ```
   - 通常は `http://[あなたのローカルIP]:3000` でアクセス可能

3. 同じWi-Fiネットワークに接続したモバイルデバイスからアクセス

#### Vercel（本番環境）でのテスト

- Vercelデプロイ後のURLを使用
- 例: `https://your-app.vercel.app`

### 2. テストシナリオの確認

以下の全シナリオをテストします。

## テストシナリオ

### シナリオ1: 初回ページロード

**目的**: 初期表示とレスポンシブデザインの確認

**手順**:
1. モバイルブラウザでアプリURLにアクセス
2. ページが正しく表示されることを確認

**確認項目**:
- [ ] ページタイトル「宇美町施設予約検索」が表示される
- [ ] 説明文が読みやすく表示される
- [ ] 検索フォームが正しくレイアウトされている
- [ ] 横スクロールが発生しない
- [ ] フォントサイズが読みやすい（最小16px）
- [ ] ページ読み込み時間が2秒以内（体感）

**期待結果**:
- すべてのUIコンポーネントが画面に収まる
- テキストが読みやすい
- レイアウトが崩れていない

---

### シナリオ2: 日付選択（カレンダーUI）

**目的**: タッチ操作の使いやすさ確認

**手順**:
1. カレンダーグリッドで日付をタップ
2. 複数の日付を選択
3. 選択した日付の解除

**確認項目**:
- [ ] タップターゲットが十分な大きさ（44px以上）
- [ ] タップした日付が視覚的にハイライトされる
- [ ] 複数日選択が正常に動作する
- [ ] 選択した日付の再タップで解除できる
- [ ] 月の切り替えボタンが正常に動作する
- [ ] 過去の日付が選択できない（グレーアウト）

**期待結果**:
- スムーズなタッチ操作
- 選択状態が明確に視覚化される
- 誤タップが少ない

---

### シナリオ3: クイック日付選択

**目的**: ワンタップでの日付選択確認

**手順**:
1. 「本日から1週間」ボタンをタップ
2. 選択された日付を確認

**確認項目**:
- [ ] ボタンが十分な大きさ（44px以上）
- [ ] タップで7日分の日付が自動選択される
- [ ] 選択結果が視覚的に確認できる
- [ ] 「選択中: 7日」と表示される

**期待結果**:
- ワンタップで7日分が選択される
- 選択状態がカレンダーに反映される

---

### シナリオ4: 時間範囲選択

**目的**: ドロップダウン操作の確認

**手順**:
1. 「From」ドロップダウンをタップ
2. 時刻を選択
3. 「To」ドロップダウンをタップ
4. 時刻を選択（Fromより後の時刻）

**確認項目**:
- [ ] ドロップダウンが正常に開く
- [ ] 30分刻みの時刻リストが表示される（8:30〜21:30）
- [ ] 選択した時刻が反映される
- [ ] 「To」が「From」より前の場合にバリデーションエラーが表示される
- [ ] エラーメッセージが読みやすい

**期待結果**:
- スムーズなドロップダウン操作
- バリデーションが正常に動作

---

### シナリオ5: 検索実行

**目的**: フォーム送信とローディング状態の確認

**手順**:
1. 日付を選択（例: 本日から1週間）
2. 時間範囲を選択（オプション）
3. 「検索」ボタンをタップ

**確認項目**:
- [ ] 検索ボタンが十分な大きさ（44px以上）
- [ ] ボタンタップが反応する
- [ ] ローディングスピナーが表示される
- [ ] 「施設情報を取得しています...」メッセージが表示される
- [ ] 検索中はボタンが無効化される

**期待結果**:
- ローディング状態が明確に表示される
- 二重送信が防止される

---

### シナリオ6: 検索結果表示

**目的**: 結果ページのレイアウトと操作性確認

**手順**:
1. 検索を実行して結果ページに遷移
2. 結果を確認

**確認項目**:
- [ ] 検索条件が正しく表示される
- [ ] 「空きのある施設」セクションが表示される
- [ ] 施設カードが正しくレイアウトされている
- [ ] 縦スクロールのみ（横スクロールなし）
- [ ] 「新しい検索」ボタンが機能する

**期待結果**:
- 結果が読みやすく表示される
- スムーズなスクロール

---

### シナリオ7: 施設カード展開/折りたたみ

**目的**: インタラクティブ要素の動作確認

**手順**:
1. 施設名をタップして展開
2. 日付ごとの空き状況を確認
3. 再度タップして折りたたみ

**確認項目**:
- [ ] タップで施設カードが展開される
- [ ] 日付ごとの空き状況が表示される
- [ ] 時間帯が30分刻みで表示される
- [ ] 空き状況が色分けされている（緑=空き、グレー=予約済み）
- [ ] タップで折りたたみができる
- [ ] アニメーションがスムーズ

**期待結果**:
- スムーズな展開/折りたたみ
- 情報が見やすく整理されている

---

### シナリオ8: 空き状況フィルタリング

**目的**: 時間帯フィルター機能の確認

**手順**:
1. 施設カードを展開
2. 「空きのみ表示」トグルをタップ

**確認項目**:
- [ ] トグルボタンが正常に動作する
- [ ] 空きのある時間帯のみが表示される
- [ ] 予約済みの時間帯が非表示になる
- [ ] トグル解除で全時間帯が再表示される

**期待結果**:
- フィルタリングが瞬時に反映される
- 表示切替がスムーズ

---

### シナリオ9: エラーハンドリング

**目的**: エラー表示とリトライ機能の確認

**手順**:
1. 意図的にエラーを発生させる（例: ネットワーク切断、空の日付で検索）
2. エラーメッセージを確認
3. リトライボタンをタップ

**確認項目**:
- [ ] エラーメッセージが読みやすく表示される
- [ ] エラーの種類に応じた適切なメッセージが表示される
- [ ] リトライボタンが表示される
- [ ] リトライボタンが十分な大きさ（44px以上）
- [ ] リトライで再試行される

**期待結果**:
- ユーザーフレンドリーなエラーメッセージ
- リトライ機能が正常に動作

---

### シナリオ10: 画面回転（縦横切り替え）

**目的**: 画面向きの変更に対する適応確認

**手順**:
1. 縦向きで検索フォームを表示
2. 画面を横向きに回転
3. 縦向きに戻す

**確認項目**:
- [ ] 縦向きでレイアウトが正しい
- [ ] 横向きでレイアウトが崩れない
- [ ] 回転時に状態が保持される
- [ ] 回転時にスクロール位置が大きく変わらない

**期待結果**:
- 両方の向きで快適に使用できる
- レイアウトの崩れがない

---

### シナリオ11: ページ遷移とブラウザバック

**目的**: ナビゲーションの確認

**手順**:
1. ホームページで検索を実行
2. 結果ページに遷移
3. ブラウザのバックボタンをタップ
4. ホームページに戻る

**確認項目**:
- [ ] ページ遷移がスムーズ
- [ ] バックボタンで前のページに戻れる
- [ ] 戻った際にフォーム状態が保持されている（望ましい）
- [ ] 履歴管理が正常

**期待結果**:
- 自然なページ遷移
- ブラウザ標準のナビゲーションが機能

---

## パフォーマンステスト

### ネットワーク速度別テスト

以下のネットワーク条件でテストを実施:

1. **Wi-Fi（高速）**
   - [ ] ページ読み込み: 2秒以内
   - [ ] 検索実行: 10秒以内

2. **4G（中速）**
   - [ ] ページ読み込み: 3秒以内
   - [ ] 検索実行: 15秒以内

3. **3G（低速）** ※オプション
   - [ ] ページ読み込み: 5秒以内
   - [ ] 検索実行: 20秒以内
   - [ ] ローディング表示が適切

## アクセシビリティテスト

### 視覚的確認

- [ ] カラーコントラスト比が4.5:1以上（目視確認）
- [ ] テキストサイズが十分（最小16px）
- [ ] タップターゲットが十分な大きさ（最小44px）
- [ ] フォーカス状態が視覚的に明確

### スクリーンリーダーテスト（オプション）

- iOS VoiceOverでの読み上げ確認
- Android TalkBackでの読み上げ確認

## テスト結果記録

### テスト実施情報

- **実施日**: _______________
- **実施者**: _______________
- **テスト環境**: _______________

### デバイス1: iOS

- **デバイス**: _______________（例: iPhone 12）
- **OS**: _______________（例: iOS 16.0）
- **ブラウザ**: Safari _______________

| シナリオ | 合格/不合格 | 備考 |
|---------|-----------|------|
| 1. 初回ページロード | ☐ | |
| 2. 日付選択 | ☐ | |
| 3. クイック日付選択 | ☐ | |
| 4. 時間範囲選択 | ☐ | |
| 5. 検索実行 | ☐ | |
| 6. 検索結果表示 | ☐ | |
| 7. 施設カード展開/折りたたみ | ☐ | |
| 8. 空き状況フィルタリング | ☐ | |
| 9. エラーハンドリング | ☐ | |
| 10. 画面回転 | ☐ | |
| 11. ページ遷移とブラウザバック | ☐ | |

### デバイス2: Android

- **デバイス**: _______________（例: Google Pixel 6）
- **OS**: _______________（例: Android 13）
- **ブラウザ**: Chrome _______________

| シナリオ | 合格/不合格 | 備考 |
|---------|-----------|------|
| 1. 初回ページロード | ☐ | |
| 2. 日付選択 | ☐ | |
| 3. クイック日付選択 | ☐ | |
| 4. 時間範囲選択 | ☐ | |
| 5. 検索実行 | ☐ | |
| 6. 検索結果表示 | ☐ | |
| 7. 施設カード展開/折りたたみ | ☐ | |
| 8. 空き状況フィルタリング | ☐ | |
| 9. エラーハンドリング | ☐ | |
| 10. 画面回転 | ☐ | |
| 11. ページ遷移とブラウザバック | ☐ | |

## 問題発見時の対応

### バグ報告テンプレート

問題を発見した場合、以下の情報を記録:

```
【問題の概要】
（簡潔な説明）

【再現手順】
1.
2.
3.

【期待される動作】
（本来どうあるべきか）

【実際の動作】
（何が起きたか）

【デバイス情報】
- デバイス:
- OS:
- ブラウザ:

【スクリーンショット】
（あれば添付）

【優先度】
☐ 緊急（使用不可）
☐ 高（主要機能に影響）
☐ 中（一部機能に影響）
☐ 低（表示の微調整など）
```

## 合格基準

すべてのテストシナリオが以下の条件を満たすこと:

- すべての必須確認項目にチェックが入る
- 重大なバグ（優先度「緊急」「高」）が0件
- ユーザー体験を損なう問題が最小限

## 参考リンク

- [iOS Safari対応状況](https://caniuse.com/)
- [Android Chrome対応状況](https://caniuse.com/)
- [タッチターゲットサイズガイドライン](https://web.dev/tap-targets/)
