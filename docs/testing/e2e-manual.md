# 手動E2Eテスト手順書

## 概要

このドキュメントは、宇美町施設予約検索システムのリリース前品質確認のための手動E2Eテストシナリオを定義します。

## テスト環境

### 必須ブラウザ
- **iOS Safari 14+** (iPhone実機)
- **Android Chrome 90+** (Android実機)

### 推奨テスト端末
- iPhone (iOS 14+) - Portrait/Landscape
- Android スマートフォン (Chrome 90+) - Portrait/Landscape
- タブレット (オプション)

### テスト準備
1. 本番環境またはステージング環境のURLにアクセス
2. ブラウザのキャッシュをクリア
3. プライベートブラウジングモード/シークレットモードを使用

---

## テストシナリオ

### シナリオ1: 基本的な検索フロー

#### 目的
ユーザーが日付を選択して施設を検索し、結果を表示できることを確認する

#### 前提条件
- アプリケーションのトップページが表示されている
- インターネット接続が安定している

#### テスト手順

1. **日付選択**
   - [ ] トップページで「本日から1週間」ボタンをタップ
   - **期待結果**: 本日から7日分の日付が自動的に選択される
   - **確認項目**:
     - 選択された日付が視覚的にハイライトされている
     - 「選択中: 7日」のテキストが表示される

2. **検索実行**
   - [ ] 「検索」ボタンをタップ
   - **期待結果**: ローディング表示後、検索結果ページに遷移する
   - **確認項目**:
     - ローディングスピナーが表示される
     - ボタンが無効化され「検索中...」と表示される

3. **結果表示**
   - [ ] 検索結果ページで施設一覧が表示される
   - **期待結果**: 施設カードが縦にスクロール可能で表示される
   - **確認項目**:
     - 各施設カードに施設名とスポーツ種目が表示される
     - 日付ごとに空き状況セクションがある
     - 空き時間帯数が正しく表示される(例: 空き: 3 / 10)

4. **空き状況の展開**
   - [ ] 任意の日付をタップして展開
   - **期待結果**: その日付の時間帯リストが表示される
   - **確認項目**:
     - 時間帯リストが表示される
     - 空きの時間帯が緑色で表示される
     - 空いていない時間帯がグレーで表示される

5. **空き状況の折りたたみ**
   - [ ] 展開された日付を再度タップ
   - **期待結果**: 時間帯リストが非表示になる

---

### シナリオ2: 時間範囲フィルタリング

#### 目的
特定の時間範囲で検索結果をフィルタリングできることを確認する

#### テスト手順

1. **日付と時間範囲の選択**
   - [ ] トップページで任意の日付を1つ選択
   - [ ] 「時間帯」の「From」ドロップダウンで「09:00」を選択
   - [ ] 「To」ドロップダウンで「12:00」を選択
   - **期待結果**: 選択した時間範囲が表示される
   - **確認項目**:
     - ドロップダウンが正しく動作する
     - 選択中の表示に時間範囲が含まれる(例: 選択中: 1日 / 09:00 〜 12:00)

2. **検索実行**
   - [ ] 「検索」ボタンをタップ
   - **期待結果**: 指定した時間範囲の空き状況のみが表示される

3. **結果の確認**
   - [ ] 日付を展開して時間帯を確認
   - **期待結果**: 09:00〜12:00の範囲の時間帯のみが表示される

---

### シナリオ3: バリデーションエラー処理

#### 目的
ユーザーが不正な入力をした際のエラー処理を確認する

#### テスト手順

1. **日付未選択エラー**
   - [ ] 日付を選択せずに「検索」ボタンをタップ
   - **期待結果**: エラーメッセージが表示される
   - **確認項目**:
     - 「検索する日付を1つ以上選択してください」というメッセージが表示される
     - メッセージが赤い背景で視認性が高い
     - 検索は実行されない

2. **エラーの解消**
   - [ ] 日付を1つ選択
   - **期待結果**: エラーメッセージが消える

3. **不正な時間範囲エラー**
   - [ ] 「From」に「18:00」、「To」に「09:00」を設定
   - [ ] 「検索」ボタンをタップ
   - **期待結果**: 「終了時刻は開始時刻より後にしてください」というエラーが表示される

---

### シナリオ4: ネットワークエラー処理

#### 目的
ネットワークエラー時の適切なエラー表示を確認する

#### 前提条件
- 開発者ツールまたはネットワーク設定でネットワークをオフラインに設定できること

#### テスト手順

1. **ネットワークの切断**
   - [ ] デバイスをオフラインモードにする(機内モード)

2. **検索実行**
   - [ ] 日付を選択して「検索」ボタンをタップ
   - **期待結果**: ネットワークエラーが表示される
   - **確認項目**:
     - エラーメッセージが表示される
     - 「再試行」ボタンが表示される

3. **再試行**
   - [ ] ネットワークを復旧
   - [ ] 「再試行」ボタンをタップ
   - **期待結果**: 検索が正常に実行される

---

### シナリオ5: レート制限の確認

#### 目的
連続リクエストがレート制限されることを確認する

#### テスト手順

1. **初回検索**
   - [ ] 日付を選択して検索を実行
   - **期待結果**: 正常に結果が表示される

2. **即座に2回目の検索**
   - [ ] ブラウザの戻るボタンでトップページに戻る
   - [ ] すぐに再度検索を実行(5秒以内)
   - **期待結果**: レート制限エラーが表示される
   - **確認項目**:
     - 「前回の検索から5秒以上経過してから再度お試しください」というメッセージが表示される
     - 「再試行」ボタンが表示される

3. **5秒待機後の再試行**
   - [ ] 5秒以上待機
   - [ ] 「再試行」ボタンをタップまたは新規検索を実行
   - **期待結果**: 検索が正常に実行される

---

### シナリオ6: レスポンシブデザインとタップ操作

#### 目的
モバイルファーストデザインとタッチ操作の快適性を確認する

#### テスト手順

1. **画面サイズの確認**
   - [ ] 縦向き(Portrait)で表示を確認
   - [ ] 横向き(Landscape)で表示を確認
   - **期待結果**:
     - 全てのコンテンツが画面内に収まる
     - 横スクロールが発生しない
     - 縦スクロールのみで全コンテンツにアクセス可能

2. **タップターゲットサイズ**
   - [ ] 全てのボタンとインタラクティブ要素をタップ
   - **期待結果**:
     - 全てのボタンが44px以上のタップ領域を持つ
     - 誤タップなく快適に操作できる
     - 隣接する要素をタップしてしまうことがない

3. **フォントサイズの確認**
   - [ ] 本文テキストの可読性を確認
   - **期待結果**:
     - 本文フォントサイズが16px以上
     - 拡大しなくても読みやすい

4. **スクロール操作**
   - [ ] 長い施設リストをスクロール
   - [ ] 長い時間帯リストをスクロール
   - **期待結果**:
     - スクロールが滑らか
     - 慣性スクロールが機能する
     - 縦方向のみのスクロール

---

### シナリオ7: 実際のスクレイピング動作確認

#### 目的
実際の宇美町施設予約システムからデータを取得できることを確認する

#### 前提条件
- 宇美町の施設予約システムが稼働中
- ネットワーク接続が安定している

#### テスト手順

1. **本番データの取得**
   - [ ] 本日から3日分の日付を選択
   - [ ] バスケットボールの施設を検索
   - **期待結果**:
     - 10秒以内に結果が表示される
     - 実際の空き状況が正確に表示される

2. **データの正確性確認**
   - [ ] 宇美町の公式サイトで同じ日付・施設の空き状況を手動で確認
   - [ ] アプリの表示結果と比較
   - **期待結果**:
     - 施設名が正確
     - 空き状況が一致
     - 時間帯が正確

3. **複数施設の確認**
   - [ ] 検索結果に複数の施設が表示される場合、それぞれを確認
   - **期待結果**:
     - 全ての施設のデータが正確
     - スクレイピングエラーがない

---

## デバイス別確認事項

### iOS Safari

- [ ] 縦向き・横向き両方で正常に表示される
- [ ] ホーム画面に追加した際のアイコンが表示される(該当する場合)
- [ ] セーフエリア(ノッチ)を考慮したレイアウトになっている
- [ ] スクロールの挙動が自然
- [ ] タップ操作に遅延がない

### Android Chrome

- [ ] 縦向き・横向き両方で正常に表示される
- [ ] 戻るボタンの動作が適切
- [ ] アドレスバーの表示・非表示時にレイアウトが崩れない
- [ ] スクロールの挙動が自然
- [ ] タップ操作に遅延がない

---

## パフォーマンス確認

### ページロード時間

- [ ] トップページが2秒以内に表示される
- [ ] 検索結果が10秒以内に表示される
- [ ] 日付の展開/折りたたみが即座に反応する

### 主観的な体感

- [ ] アニメーションが滑らか(60fps)
- [ ] ボタンタップの反応が即座
- [ ] ページ遷移がスムーズ

---

## アクセシビリティ確認

- [ ] VoiceOver/TalkBack有効時に操作可能
- [ ] 画面リーダーで全ての情報が読み上げられる
- [ ] コントラスト比が4.5:1以上
- [ ] フォーカス順序が論理的
- [ ] エラーメッセージが音声で伝わる

---

## 不具合発見時の記録項目

不具合を発見した場合、以下の情報を記録してください:

1. **デバイス情報**
   - 機種名
   - OS バージョン
   - ブラウザ バージョン

2. **再現手順**
   - 詳細な操作手順
   - 入力した値

3. **期待される動作**
   - 何が起こるべきだったか

4. **実際の動作**
   - 何が起こったか

5. **スクリーンショット/動画**
   - 可能であれば証拠を残す

6. **発生頻度**
   - 100%再現 / 時々発生 / 稀

---

## テスト完了チェックリスト

### 必須項目
- [ ] シナリオ1: 基本的な検索フロー (iOS)
- [ ] シナリオ1: 基本的な検索フロー (Android)
- [ ] シナリオ2: 時間範囲フィルタリング (iOS)
- [ ] シナリオ2: 時間範囲フィルタリング (Android)
- [ ] シナリオ3: バリデーションエラー処理 (iOS)
- [ ] シナリオ3: バリデーションエラー処理 (Android)
- [ ] シナリオ6: レスポンシブデザインとタップ操作 (iOS)
- [ ] シナリオ6: レスポンシブデザインとタップ操作 (Android)
- [ ] シナリオ7: 実際のスクレイピング動作確認 (iOS)
- [ ] シナリオ7: 実際のスクレイピング動作確認 (Android)

### 推奨項目
- [ ] シナリオ4: ネットワークエラー処理 (iOS)
- [ ] シナリオ4: ネットワークエラー処理 (Android)
- [ ] シナリオ5: レート制限の確認 (iOS)
- [ ] シナリオ5: レート制限の確認 (Android)
- [ ] パフォーマンス確認 (iOS)
- [ ] パフォーマンス確認 (Android)
- [ ] アクセシビリティ確認 (iOS)
- [ ] アクセシビリティ確認 (Android)

---

## テスト結果サマリー

| 項目 | iOS Safari | Android Chrome | 備考 |
|------|-----------|---------------|------|
| 基本的な検索フロー | ⬜ | ⬜ | |
| 時間範囲フィルタリング | ⬜ | ⬜ | |
| バリデーションエラー | ⬜ | ⬜ | |
| ネットワークエラー | ⬜ | ⬜ | |
| レート制限 | ⬜ | ⬜ | |
| レスポンシブデザイン | ⬜ | ⬜ | |
| 実際のスクレイピング | ⬜ | ⬜ | |
| パフォーマンス | ⬜ | ⬜ | |
| アクセシビリティ | ⬜ | ⬜ | |

**凡例**: ⬜ 未実施 / ✅ 合格 / ❌ 不合格 / ⚠️ 要改善

---

## 改訂履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|------|---------|---------|--------|
| 2025-12-06 | 1.0 | 初版作成 | Claude |
